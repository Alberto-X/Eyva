<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ux_data_broker_scriptlet">
    <sys_ux_data_broker_scriptlet action="DELETE">
        <api_name>x_802331_eyva.MSP modal save action</api_name>
        <description>Saves data from the "manage shift position" (MSP) modal</description>
        <mutates_server_data>false</mutates_server_data>
        <name>MSP modal save action</name>
        <output_schema>{&#13;
  "$schema": "https://json-schema.org/draft/2020-12/schema",&#13;
  "$id": "https://example.com/product.schema.json",&#13;
  "title": "Response",&#13;
  "description": "The response from the server",&#13;
  "type": "object",&#13;
  "properties": {&#13;
    "message": {&#13;
      "description": "A brief message from the server",&#13;
      "type": "string"&#13;
    }&#13;
  }&#13;
}</output_schema>
        <private>false</private>
        <props>[&#13;
  {&#13;
    "name": "workers",&#13;
    "label": "Workers",&#13;
    "description": "Workers and assignments being saved",&#13;
    "readOnly": "false",&#13;
    "fieldType": "array",&#13;
    "mandatory": "true",&#13;
    "defaultValue": []&#13;
  },&#13;
  {&#13;
    "name": "shiftPosition",&#13;
    "label": "Shift position",&#13;
    "description": "Shift position that users should be added to",&#13;
    "readOnly": "false",&#13;
    "fieldType": "object",&#13;
    "mandatory": "true",&#13;
    "defaultValue": {}&#13;
  }&#13;
]</props>
        <required_translations>[ {
  "message" : "Shift position",
  "comment" : ""
}, {
  "message" : "Shift position that users should be added to",
  "comment" : ""
}, {
  "message" : "Workers",
  "comment" : ""
}, {
  "message" : "Workers and assignments being saved",
  "comment" : ""
} ]</required_translations>
        <schema_version>1.0.0</schema_version>
        <script><![CDATA[function transform(input) {
	input.workers.forEach(function(wkr) {
		if (wkr.deleted && wkr.shiftPositionWorker) {
			//gs.info('delete ' + wkr.label);
			var grToDelete = new GlideRecord('x_802331_eyva_shift_position_worker');
			grToDelete.get(wkr.shiftPositionWorker);
		}
		if (wkr.deleted && wkr.shiftWorker) {
			//gs.info('delete ' + wkr.label);
			var grToDelete = new GlideRecord('x_802331_eyva_shift');
			grToDelete.get(wkr.shiftWorker);
		}
		if (!wkr.active) {
			return;
		}
		if (wkr.id == 'new-worker') {
			// Create user and worker
		}
		if (!wkr.shiftWorker) {
			// Add worker to shift
		}
		if (!wkr.shiftPositionWorker && wkr.assigned) {
			// Add worker to position
		}
		if (wkr.shiftPositionWorker && !wkr.assigned) {
			// Remove worker from position
		}
		if (wkr.shiftPositionWorker && wkr.assigned) {
			// Move worker to new position
		}
	});
	return { message: 'Worker assignments updated' };
}]]></script>
        <sys_class_name>sys_ux_data_broker_scriptlet</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-07-31 07:00:52</sys_created_on>
        <sys_id>176337a24750bd102dabcd9bd36d4364</sys_id>
        <sys_mod_count>10</sys_mod_count>
        <sys_name>MSP modal save action</sys_name>
        <sys_package display_value="Eyva" source="x_802331_eyva">04928fc32fd41110da77c886f699b615</sys_package>
        <sys_policy/>
        <sys_scope display_value="Eyva">04928fc32fd41110da77c886f699b615</sys_scope>
        <sys_update_name>sys_ux_data_broker_scriptlet_176337a24750bd102dabcd9bd36d4364</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-08-02 04:11:00</sys_updated_on>
    </sys_ux_data_broker_scriptlet>
    <sys_translated_text action="DELETE" query="documentkey=176337a24750bd102dabcd9bd36d4364"/>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Eyva">04928fc32fd41110da77c886f699b615</application>
        <file_path/>
        <instance_id>27b446f6db6de1180b9d21c405961992</instance_id>
        <instance_name>dev165277</instance_name>
        <name>sys_ux_data_broker_scriptlet_176337a24750bd102dabcd9bd36d4364</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ux_data_broker_scriptlet"&gt;&lt;sys_ux_data_broker_scriptlet action="INSERT_OR_UPDATE"&gt;&lt;api_name&gt;x_802331_eyva.MSP modal save action&lt;/api_name&gt;&lt;description&gt;Saves data from the "manage shift position" (MSP) modal&lt;/description&gt;&lt;mutates_server_data&gt;false&lt;/mutates_server_data&gt;&lt;name&gt;MSP modal save action&lt;/name&gt;&lt;output_schema&gt;{&amp;#13;
  "$schema": "https://json-schema.org/draft/2020-12/schema",&amp;#13;
  "$id": "https://example.com/product.schema.json",&amp;#13;
  "title": "Response",&amp;#13;
  "description": "The response from the server",&amp;#13;
  "type": "object",&amp;#13;
  "properties": {&amp;#13;
    "message": {&amp;#13;
      "description": "A brief message from the server",&amp;#13;
      "type": "string"&amp;#13;
    }&amp;#13;
  }&amp;#13;
}&lt;/output_schema&gt;&lt;private&gt;false&lt;/private&gt;&lt;props&gt;[&amp;#13;
  {&amp;#13;
    "name": "workers",&amp;#13;
    "label": "Workers",&amp;#13;
    "description": "Workers and assignments being saved",&amp;#13;
    "readOnly": "false",&amp;#13;
    "fieldType": "array",&amp;#13;
    "mandatory": "true",&amp;#13;
    "defaultValue": []&amp;#13;
  },&amp;#13;
  {&amp;#13;
    "name": "shiftPosition",&amp;#13;
    "label": "Shift position",&amp;#13;
    "description": "Shift position that users should be added to",&amp;#13;
    "readOnly": "false",&amp;#13;
    "fieldType": "object",&amp;#13;
    "mandatory": "true",&amp;#13;
    "defaultValue": {}&amp;#13;
  }&amp;#13;
]&lt;/props&gt;&lt;required_translations&gt;[ {
  "message" : "Shift position",
  "comment" : ""
}, {
  "message" : "Shift position that users should be added to",
  "comment" : ""
}, {
  "message" : "Workers",
  "comment" : ""
}, {
  "message" : "Workers and assignments being saved",
  "comment" : ""
} ]&lt;/required_translations&gt;&lt;schema_version&gt;1.0.0&lt;/schema_version&gt;&lt;script&gt;&lt;![CDATA[function transform(input) {
	input.workers.forEach(function(wkr) {
		if (wkr.deleted &amp;&amp; wkr.shiftPositionWorker) {
			//gs.info('delete ' + wkr.label);
			var grToDelete = new GlideRecord('x_802331_eyva_shift_position_worker');
			grToDelete.get(wkr.shiftPositionWorker);
		}
		if (wkr.deleted &amp;&amp; wkr.shiftWorker) {
			//gs.info('delete ' + wkr.label);
			var grToDelete = new GlideRecord('x_802331_eyva_shift');
			grToDelete.get(wkr.shiftWorker);
		}
		if (!wkr.active) {
			return;
		}
		if (wkr.id == 'new-worker') {
			// Create user and worker
		}
		if (!wkr.shiftWorker) {
			// Add worker to shift
		}
		if (!wkr.shiftPositionWorker &amp;&amp; wkr.assigned) {
			// Add worker to position
		}
		if (wkr.shiftPositionWorker &amp;&amp; !wkr.assigned) {
			// Remove worker from position
		}
		if (wkr.shiftPositionWorker &amp;&amp; wkr.assigned) {
			// Move worker to new position
		}
	});
	return { message: 'Worker assignments updated' };
}]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_ux_data_broker_scriptlet&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-07-31 07:00:52&lt;/sys_created_on&gt;&lt;sys_id&gt;176337a24750bd102dabcd9bd36d4364&lt;/sys_id&gt;&lt;sys_mod_count&gt;10&lt;/sys_mod_count&gt;&lt;sys_name&gt;MSP modal save action&lt;/sys_name&gt;&lt;sys_package display_value="Eyva" source="x_802331_eyva"&gt;04928fc32fd41110da77c886f699b615&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Eyva"&gt;04928fc32fd41110da77c886f699b615&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ux_data_broker_scriptlet_176337a24750bd102dabcd9bd36d4364&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-08-02 04:11:00&lt;/sys_updated_on&gt;&lt;/sys_ux_data_broker_scriptlet&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=176337a24750bd102dabcd9bd36d4364"/&gt;&lt;/record_update&gt;</payload>
        <payload_hash>1456314921</payload_hash>
        <record_name>MSP modal save action</record_name>
        <reverted_from/>
        <source>682e7085472321102dabcd9bd36d43b1</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-08-02 04:11:00</sys_created_on>
        <sys_id>e754699347d031102dabcd9bd36d4345</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>189b47121a70000001</sys_recorded_at>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-08-02 04:11:00</sys_updated_on>
        <type>Data Broker Scriptlet</type>
        <update_guid>6f5469933fd03110a564204a5ddf0f44</update_guid>
        <update_guid_history>6f5469933fd03110a564204a5ddf0f44:1456314921,4b2336f61a9cbd103c0325c750c56db2:-1333943686,a6427e7a2b9cbd10985da72c4e562b14:-813823687,8da1367a699cbd1050362169e5bec5bf:181116291,8bace6f25f9cbd101c00505416c59b43:874818083,86b148b21c90bd1017578cee1618c61c:-2036157542,feed376e1550bd10682c60adcf70a5c9:1888489200,bbbd37ea5250bd100298650218a4d176:-1725539226,0a2cfb6a3350bd1047ae9364d0ce8e8a:-546786529,abdbfb6abc50bd1040b2cf305ef4af77:-1292647943,b4183fa68650bd102e13dda3492e8241:-2084220513</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete/>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-08-02 05:50:00</sys_created_on>
        <sys_db_object display_value="" name="sys_ux_data_broker_scriptlet">sys_ux_data_broker_scriptlet</sys_db_object>
        <sys_id>06bd1450b99d4bb7803dd4b3aee3d659</sys_id>
        <sys_metadata>176337a24750bd102dabcd9bd36d4364</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>MSP modal save action</sys_name>
        <sys_package display_value="Eyva" source="x_802331_eyva">04928fc32fd41110da77c886f699b615</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_scope display_value="Eyva">04928fc32fd41110da77c886f699b615</sys_scope>
        <sys_scope_delete display_value="">240812431724428091a64e1ecd53f240</sys_scope_delete>
        <sys_update_name>sys_ux_data_broker_scriptlet_176337a24750bd102dabcd9bd36d4364</sys_update_name>
        <sys_update_version display_value="sys_ux_data_broker_scriptlet_176337a24750bd102dabcd9bd36d4364">e754699347d031102dabcd9bd36d4345</sys_update_version>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-08-02 05:50:00</sys_updated_on>
    </sys_metadata_delete>
</record_update>
